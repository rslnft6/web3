<!DOCTYPE html>  
<html lang="ar" dir="rtl">  
<head>  
    <script src="https://cdn.jsdelivr.net/npm/web3@1.6.1/dist/web3.min.js"></script>  
    <script src="https://cdn.web3.storage/dist/bundle.min.js"></script>  
    <style>  
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¹Ø±Ø¨ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© */  
        body { font-family: 'Tajawal', sans-serif; }  
        .converter-box {  
            border: 2px dashed #4e89ae;  
            padding: 25px;  
            border-radius: 15px;  
            background: rgba(78, 137, 174, 0.05);  
        }  
    </style>  
</head>  
<body>  

<div class="converter-box">  
    <h2>ğŸ”„ Ù…Ø­ÙˆÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¥Ù„Ù‰ Web3</h2>  
    <input type="url" id="appUrl" placeholder="https://ØªØ·Ø¨ÙŠÙ‚Ùƒ.com" class="form-control">  
    <button onclick="convertApp()" class="btn">ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¢Ù† (0.001 ETH)</button>  
    <div id="result"></div>  
</div>  

<script>  
const WEB3_STORAGE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.xxxxxxxx"; // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù…ÙØªØ§Ø­Ùƒ  
  
async function convertApp() {  
    const appUrl = document.getElementById('appUrl').value;  
    if (!appUrl) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚");  
    
    try {  
        // 1. Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…Ø­ÙØ¸Ø©  
        if (!window.ethereum) throw new Error("MetaMask ØºÙŠØ± Ù…Ø«Ø¨Øª!");  
        await ethereum.request({ method: 'eth_requestAccounts' });  
          
        // 2. Ø§Ù„Ø¯ÙØ¹  
        const accounts = await new Web3(ethereum).eth.getAccounts();  
        await ethereum.request({  
            method: 'eth_sendTransaction',  
            params: [{  
                from: accounts[0],  
                to: "0x742d35Cc6634C0532925a3b844Bc454e4438f44e",  
                value: "0x38D7EA4C68000", // 0.001 ETH  
                chainId: "0xAA36A7" // Ø´Ø¨ÙƒØ© Sepolia  
            }]  
        });  
          
        // 3. ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚  
        document.getElementById('result').innerHTML = "Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„...";  
        const response = await fetch(`https://corsproxy.io/?${appUrl}`);  
        const htmlContent = await response.text();  
          
        // 4. Ø±ÙØ¹ Ø¥Ù„Ù‰ IPFS  
        const client = new Web3Storage({ token: WEB3_STORAGE_KEY });  
        const file = new File([htmlContent], "index.html", { type: "text/html" });  
        const cid = await client.put([file], { wrapWithDirectory: false });  
          
        // 5. Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©  
        const web3Url = `https://${cid}.ipfs.dweb.link`;  
        document.getElementById('result').innerHTML = `  
            <div class="alert success">  
                <h3>âœ… ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</h3>  
                <p>Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬Ø¯ÙŠØ¯:  
                <a href="${web3Url}" target="_blank">${web3Url}</a></p>  
                <p>ØªÙ… ØªØ®Ø²ÙŠÙ†Ù‡ Ø¹Ù„Ù‰ Ø´Ø¨ÙƒØ© IPFS Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù…</p>  
            </div>  
        `;  
          
    } catch (error) {  
        document.getElementById('result').innerHTML = `  
            <div class="alert error">  
                âŒ Ø­Ø¯Ø« Ø®Ø·Ø£: ${error.message}  
            </div>  
        `;  
    }  
}  
</script>  
</body>  
</html>  
